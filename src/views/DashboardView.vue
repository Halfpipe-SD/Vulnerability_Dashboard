<template>
  <div>
    <v-card class="mt-4">
      <v-toolbar flat color="primary" dark>
        <v-toolbar-title>CI/CD Juice-Shop Pipeline Results</v-toolbar-title>
      </v-toolbar>
      <v-tabs vertical>
        <v-tab
          v-for="tab in tabs"
          :key="tab.icon"
          class="align-self-start"
          @click="load_tab(tab)"
        >
          <v-icon left>{{ tab.icon }}</v-icon>
          {{ tab.label }}
        </v-tab>

        <!-- OVERVIEW -->
        <v-tab-item>
          <v-card flat min-height="600">
            <v-card-text>
              <v-row justify="center" class="py-3">
                <!-- Timeline Column -->
                <v-col cols="4" xl="3">
                  <v-timeline dense>
                    <v-timeline-item icon class="align-center text-h6">
                      <template v-slot:icon>
                        <v-icon dark>mdi-play</v-icon>
                      </template>

                      <v-row dense align="start" justify="start" no-gutters>
                        <v-col cols="12">
                          Pipeline #
                          <a :href="timelineJobs[0]?.pipeline.web_url">{{
                            timelineJobs[0]?.pipeline.id
                          }}</a>
                          <v-divider></v-divider>
                        </v-col>

                        <v-col cols="auto" class="mr-1">
                          <span class="text-caption font-weight-bold">
                            <v-icon dense> mdi-source-commit</v-icon>
                            #<a :href="timelineJobs[0]?.commit.web_url">{{
                              timelineJobs[0]?.commit.short_id
                            }}</a>
                          </span>
                        </v-col>
                        <v-col cols="auto" class="mr-1">
                          <v-tooltip bottom>
                            <template v-slot:activator="{ on }">
                              <v-avatar size="25">
                                <img
                                  :src="
                                    getAuthorAvatar(
                                      timelineJobs[0]?.commit.author_name
                                    )
                                  "
                                  alt="Author"
                                  v-on="on"
                                />
                              </v-avatar>
                            </template>
                            <span>{{
                              timelineJobs[0]?.commit.author_name
                            }}</span>
                          </v-tooltip>
                        </v-col>
                        <v-col cols="auto" align-self="center">
                          <span class="text-subtitle-2 font-weight-bold">
                            {{
                              getTimePassed(
                                timelineJobs[0]?.pipeline.updated_at
                              )
                            }}
                          </span>
                        </v-col>
                        <v-col cols="12" class="text-body-2">
                          {{ timelineJobs[0]?.commit.message }}
                        </v-col>
                      </v-row>
                    </v-timeline-item>

                    <v-timeline-item
                      :icon="getJobIcon(job.status)"
                      v-for="job in timelineJobs"
                      :key="job.id"
                      :color="getJobColor(job.status)"
                    >
                      <v-row justify="start" dense no-gutters>
                        <v-col cols="auto" class="mr-1">
                          <span
                            class="align-center text-subtitle-2 font-weight-bold"
                          >
                            {{ job.name }}
                            <span v-if="getVulnerabilityCount(job.name) != 0">
                              <v-tooltip right color="light-green lighten-5">
                                <template v-slot:activator="{ on, attrs }">
                                  <v-icon
                                    color="purple"
                                    dense
                                    class="ml-1"
                                    v-bind="attrs"
                                    v-on="on"
                                  >
                                    mdi-alert-decagram-outline
                                  </v-icon>
                                </template>

                                <v-row justify="start" dense no-gutters>
                                  <v-col>
                                    <span
                                      class="mr-1 purple--text font-weight-bold"
                                    >
                                      {{ getVulnerabilityCount(job.name) }}
                                    </span>
                                  </v-col>
                                  <v-col
                                    cols="auto"
                                    class="purple--text font-weight-bold"
                                  >
                                    Vulnerabilities
                                  </v-col>
                                </v-row>
                              </v-tooltip>
                            </span>
                          </span>
                        </v-col>
                        <v-col cols="12" xl="auto">
                          #<a :href="job.web_url" class="text-subtitle-2 mr-1">
                            {{ job.id }}
                          </a>
                          {{ getTimeTaken(job.finished_at, job.started_at) }}
                        </v-col>
                      </v-row>
                    </v-timeline-item>
                  </v-timeline>
                </v-col>

                <v-divider vertical></v-divider>

                <!-- severities -->
                <v-col>
                  <v-row justify="center">
                    <!-- <v-col cols="12" class="pb-2">
                      <v-card-title class="pb-0 pt-6">
                        Total of Severities
                      </v-card-title>
                      <v-divider></v-divider>
                    </v-col> -->
                    <v-col
                      cols="auto"
                      lg="auto"
                      v-for="(severity, index) in severities"
                      :key="index"
                    >
                      <v-card outlined elevation="2">
                        <v-card-title class="pb-0">
                          {{ severity.severity }}
                        </v-card-title>
                        <v-card-actions
                          ><v-row justify="center" dense>
                            <v-col cols="auto">
                              <v-card
                                shaped
                                elevation="0"
                                dark
                                :color="getSeverityColor(severity.severity)"
                                height="100"
                                width="100"
                                :style="{
                                  fontSize: getFontSize()
                                }"
                                class="d-flex justify-center align-center"
                              >
                                <v-row
                                  justify="center"
                                  align="center"
                                  align-content="center"
                                >
                                  <v-col cols="auto" class="font-weight-bold">
                                    {{ severity.count }}
                                  </v-col>
                                </v-row></v-card
                              >
                            </v-col>
                          </v-row>
                        </v-card-actions>
                      </v-card>
                    </v-col>
                    <v-col cols="12">
                      <v-tabs v-model="tabsCWECVE">
                        <v-tab>
                          <v-badge :content="CWEItems.length">CWEs</v-badge>
                        </v-tab>
                        <v-tab>
                          <v-badge :content="CVEItems.length">CVEs</v-badge>
                        </v-tab>
                        <v-tabs-items v-model="tabsCWECVE">
                          <v-tab-item>
                            <v-card class="mx-auto" max-width="100%" outlined>
                              <!-- <v-card-title>
                                Common Weakness Enumeration. Found:
                                {{ CWEItems.length }}
                              </v-card-title> -->
                              <v-data-table
                                :headers="CWEHeaders"
                                :items="CWEItems"
                                :items-per-page="6"
                                :header-props="{ sortIcon: null }"
                                item-key="index"
                                @click:row="dialogMethodeCWE"
                              >
                                <template v-slot:[`item.pos`]="{ item }">
                                  {{ item.index }}
                                </template>

                                <template
                                  v-slot:[`item.description`]="{ item }"
                                >
                                  {{
                                    item.description
                                      ? item.description
                                      : "Description Not Available"
                                  }}
                                </template>

                                <template v-slot:[`item.count`]="{ item }">
                                  <v-chip outlined color="primary" small>
                                    {{ item.count }}</v-chip
                                  >
                                </template>

                                <template
                                  v-slot:[`item.id.likelihood_of_exploit`]="{
                                    item
                                  }"
                                >
                                  <v-chip
                                    outlined
                                    :color="
                                      getSeverityColor(
                                        item.id.likelihood_of_exploit
                                      )
                                    "
                                    small
                                  >
                                    {{
                                      item.id.likelihood_of_exploit
                                        ? item.id.likelihood_of_exploit
                                        : "N/A"
                                    }}</v-chip
                                  >
                                </template>
                              </v-data-table>
                            </v-card>
                          </v-tab-item>
                          <v-tab-item>
                            <v-card class="mx-auto" max-width="100%" outlined>
                              <v-data-table
                                :headers="CVEHeaders"
                                :items="CVEItems"
                                :items-per-page="6"
                                item-key="index"
                                sort-by="index"
                                :header-props="{ sortIcon: null }"
                              >
                                <template
                                  v-slot:[`item.description`]="{ item }"
                                >
                                  {{
                                    item.description
                                      ? item.description
                                      : "Description Not Available"
                                  }}
                                </template>
                                <template v-slot:[`item.no`]="{ index }">
                                  {{ index + 1 }}
                                </template>
                                <template v-slot:[`item.reference`]="{ item }">
                                  <v-btn
                                    outlined
                                    :href="item.reference"
                                    small
                                    color="primary"
                                  >
                                    Info
                                  </v-btn>
                                </template>
                              </v-data-table>
                            </v-card>
                          </v-tab-item>
                        </v-tabs-items>
                      </v-tabs>
                    </v-col>
                  </v-row>
                </v-col>
              </v-row>
            </v-card-text>
          </v-card>

          <!-- CWE DIAlOG -->
          <v-dialog v-model="dialogCWE" max-width="auto">
            <v-card v-if="dialogCWE">
              <v-container>
                <v-card-title class="text-h4 font-weight-bold">
                  {{ dialogItem.id.short }}
                </v-card-title>
                <v-card-subtitle class="text-h6 font-weight-medium">
                  {{ dialogItem.description }}
                </v-card-subtitle>
                <v-card-text>
                  <v-row>
                    <v-col cols="4">
                      <v-text-field
                        :value="
                          dialogItem.cves
                            ? dialogItem.cves
                            : 'Information Not Provided'
                        "
                        label="CVES "
                        outlined
                        readonly
                        hide-details="true"
                      >
                      </v-text-field>
                    </v-col>
                    <v-col cols="4">
                      <v-text-field
                        :value="
                          dialogItem.id.likelihood_of_exploit
                            ? dialogItem.id.likelihood_of_exploit
                            : 'Information Not Provided'
                        "
                        label="likelihood of exploit"
                        outlined
                        readonly
                        hide-details="true"
                      >
                      </v-text-field>
                    </v-col>
                    <v-col cols="4">
                      <v-text-field
                        :value="
                          dialogItem.count
                            ? dialogItem.count
                            : 'Information Not Provided'
                        "
                        label="Detected "
                        outlined
                        readonly
                        hide-details="true"
                      >
                      </v-text-field>
                    </v-col>
                  </v-row>
                </v-card-text>
                <v-container class="py-0">
                  <v-card-title class="pb-1"> Consequences </v-card-title>
                  <v-data-table
                    :headers="consequencesHeaders"
                    :items="dialogItem.id.consequences"
                    item-key="index"
                    :items-per-page="6"
                  >
                    <template v-slot:no-data>
                      <div class="text-h6 font-weight-black">NO DATA HERE!</div>
                    </template>

                    <template v-slot:[`item.Scope`]="{ item }">
                      <v-row dense class="my-1">
                        <v-col
                          v-for="(scope, index) in item.Scope"
                          :key="index"
                          cols="12"
                        >
                          <v-chip outlined color="primary" small>
                            {{ scope }}
                          </v-chip>
                        </v-col>
                      </v-row>
                    </template>

                    <template v-slot:[`item.Impact`]="{ item }">
                      <v-row dense>
                        <v-col
                          v-for="(impact, index) in item.Impact"
                          :key="index"
                          cols="12"
                        >
                          <v-chip outlined color="secondary" small>
                            {{ impact }}
                          </v-chip>
                        </v-col>
                      </v-row>
                    </template>
                  </v-data-table>
                </v-container>
                <v-container class="py-1">
                  <v-card-title class="py-1"> Observed Examples </v-card-title>
                  <v-data-table
                    :headers="observedExamplesHeaders"
                    :items="
                      dialogItem.id.observed_examples
                        ? dialogItem.id.observed_examples
                        : []
                    "
                    item-key="index"
                    :items-per-page="5"
                    dense
                  >
                    <template v-slot:no-data>
                      <div class="text-h6 font-weight-black">NO DATA HERE!</div>
                    </template>
                    <template v-slot:[`item.Link`]="{ item }">
                      <v-chip
                        outlined
                        color="primary"
                        x-small
                        :href="item.Link"
                      >
                        Link</v-chip
                      >
                    </template>
                  </v-data-table>
                </v-container>
              </v-container>
            </v-card>
          </v-dialog>
        </v-tab-item>

        <!-- Package -->
        <v-tab-item>
          <v-card flat height="100%">
            <v-container>
              <v-card-title> Package Log </v-card-title>

              <v-card outlined dark>
                <v-container>
                  <pre>{{ packageLog }}</pre>
                </v-container>
              </v-card>
            </v-container>
          </v-card>
        </v-tab-item>

        <!-- SAST-Semgrep -->
        <v-tab-item>
          <v-card flat min-height="600">
            <v-container>
              <v-card flat height="100%">
                <v-card-title> Semgrep </v-card-title>
                <v-card-subtitle>
                  Static Application Security Testing
                </v-card-subtitle>

                <v-card outlined>
                  <v-container>
                    <v-data-table
                      :headers="semgrepHeaders"
                      :items="semgrepItems"
                      :items-per-page="10"
                      dense
                      :expanded.sync="expanded"
                      item-key="index"
                      show-expand
                    >
                      <template
                        v-slot:[`item.vulnerability.confidence`]="{ item }"
                      >
                        <v-chip
                          outlined
                          small
                          :color="
                            item.vulnerability.confidence == 'CRITICAL'
                              ? 'purple'
                              : item.vulnerability.confidence == 'HIGH'
                              ? 'red'
                              : item.vulnerability.confidence == 'MEDIUM'
                              ? 'orange'
                              : 'blue'
                          "
                          >{{ item.vulnerability.confidence }}</v-chip
                        >
                      </template>

                      <template v-slot:[`item.file`]="{ item }">
                        {{ item.file.path }}
                      </template>

                      <template
                        v-slot:[`item.vulnerability.severity`]="{ item }"
                      >
                        <v-chip
                          outlined
                          small
                          :color="
                            item.vulnerability.severity == 'CRITICAL'
                              ? 'purple'
                              : item.vulnerability.severity == 'HIGH'
                              ? 'red'
                              : item.vulnerability.severity == 'MEDIUM'
                              ? 'orange'
                              : 'blue'
                          "
                        >
                          {{ item.vulnerability.severity }}
                        </v-chip>
                      </template>
                      <template
                        v-slot:[`item.vulnerability.reference`]="{ item }"
                      >
                        <v-btn
                          :href="item.vulnerability.reference"
                          x-small
                          outlined
                          color="primary"
                        >
                          Link
                        </v-btn>
                      </template>

                      <template v-slot:[`item.vulnerability.cwe[0]`]="{ item }">
                        {{ item.vulnerability.cwe.short }}:
                        {{ item.vulnerability.cwe.description }}
                      </template>

                      <template v-slot:expanded-item="{ headers, item }">
                        <td :colspan="headers.length" class="px-0">
                          <v-card width="100%" flat tile>
                            <v-container>
                              <v-data-table
                                :headers="semgrepDetailsHeaders"
                                :items="[item]"
                                item-key="index"
                                hide-default-footer
                                dense
                              >
                              </v-data-table>
                            </v-container>
                          </v-card>
                        </td>
                      </template>
                    </v-data-table>
                  </v-container>
                </v-card>
              </v-card>
            </v-container>
          </v-card>
        </v-tab-item>

        <!-- SAST-Gitleak -->
        <v-tab-item>
          <v-card flat min-height="600">
            <v-container>
              <v-card flat height="100%">
                <v-card-title> GitLeaks </v-card-title>
                <v-card-subtitle>
                  Static Application Security Testing
                </v-card-subtitle>

                <v-card outlined>
                  <v-container>
                    <v-data-table
                      :headers="gitleaksHeaders"
                      :items="gitleaksItems"
                      :items-per-page="10"
                      dense
                      item-key="index"
                    >
                      <template
                        v-slot:[`item.vulnerability.confidence`]="{ item }"
                      >
                        <v-chip
                          outlined
                          small
                          :color="
                            item.vulnerability.confidence == 'CRITICAL'
                              ? 'purple'
                              : item.vulnerability.confidence == 'HIGH'
                              ? 'red'
                              : item.vulnerability.confidence == 'MEDIUM'
                              ? 'orange'
                              : 'blue'
                          "
                        >
                          {{ item.vulnerability.confidence }}
                        </v-chip>
                      </template>

                      <template v-slot:[`item.file`]="{ item }">
                        {{ item.file.path }}
                      </template>
                      <template
                        v-slot:[`item.vulnerability.severity`]="{ item }"
                      >
                        <v-chip
                          outlined
                          small
                          :color="
                            item.vulnerability.severity == 'CRITICAL'
                              ? 'purple'
                              : item.vulnerability.severity == 'HIGH'
                              ? 'red'
                              : item.vulnerability.severity == 'MEDIUM'
                              ? 'orange'
                              : 'blue'
                          "
                        >
                          {{ item.vulnerability.severity }}
                        </v-chip>
                      </template>
                      <template v-slot:[`item.vulnerability.cwe[0]`]="{ item }">
                        {{ item.vulnerability.cwe.short }}:
                        {{ item.vulnerability.cwe.description }}
                      </template>
                    </v-data-table>
                  </v-container>
                </v-card>
              </v-card>
            </v-container>
          </v-card>
        </v-tab-item>
        <!-- SCA-Package -->
        <v-tab-item>
          <v-card flat min-height="600">
            <v-container>
              <v-card flat height="100%">
                <v-card-title> Package </v-card-title>
                <v-card-subtitle>
                  Software Composition Analysis
                </v-card-subtitle>

                <v-card outlined>
                  <v-container>
                    <v-data-table
                      :headers="scaPackageHeaders"
                      :items="scaPackageItems"
                      :items-per-page="10"
                      dense
                      :expanded.sync="expanded"
                      item-key="index"
                      show-expand
                      :header-props="{ sortIcon: null }"
                    >
                      <template
                        v-slot:[`item.vulnerability.confidence`]="{ item }"
                      >
                        <v-chip
                          outlined
                          small
                          :color="
                            item.vulnerability.confidence == 'CRITICAL'
                              ? 'purple'
                              : item.vulnerability.confidence == 'HIGH'
                              ? 'red'
                              : item.vulnerability.confidence == 'MEDIUM'
                              ? 'orange'
                              : 'blue'
                          "
                          >{{ item.vulnerability.confidence }}</v-chip
                        >
                      </template>

                      <template v-slot:[`item.file`]="{ item }">
                        {{ item.file.path }}
                      </template>

                      <template
                        v-slot:[`item.vulnerability.severity`]="{ item }"
                      >
                        <v-chip
                          outlined
                          small
                          :color="
                            item.vulnerability.severity == 'CRITICAL'
                              ? 'purple'
                              : item.vulnerability.severity == 'HIGH'
                              ? 'red'
                              : item.vulnerability.severity == 'MEDIUM'
                              ? 'orange'
                              : 'blue'
                          "
                        >
                          {{ item.vulnerability.severity }}
                        </v-chip>
                      </template>
                      <template v-slot:[`item.vulnerability.cwe[0]`]="{ item }">
                        {{ item.vulnerability.cwe.short }}:
                        {{ item.vulnerability.cwe.description }}
                      </template>
                      <template
                        v-slot:[`item.vulnerability.reference`]="{ item }"
                      >
                        <v-btn
                          :href="item.vulnerability.reference"
                          x-small
                          outlined
                          color="primary"
                        >
                          Link
                        </v-btn>
                      </template>

                      <template v-slot:expanded-item="{ headers, item }">
                        <td :colspan="headers.length" class="px-0">
                          <v-card width="100%" flat tile>
                            <v-container>
                              <v-data-table
                                :headers="semgrepDetailsHeaders"
                                :items="[item]"
                                item-key="index"
                                hide-default-footer
                                dense
                              >
                              </v-data-table>
                            </v-container>
                          </v-card>
                        </td>
                      </template>
                    </v-data-table>
                  </v-container>
                </v-card>
              </v-card>
            </v-container>
          </v-card>
        </v-tab-item>
        <!-- Publish -->
        <v-tab-item>
          <v-card flat height="100%">
            <v-container>
              <v-card-title> Publish Log </v-card-title>
              <v-card outlined dark>
                <v-container>
                  <pre>{{ publishLog }}</pre>
                </v-container>
              </v-card>
            </v-container>
          </v-card>
        </v-tab-item>
        <!-- SCA-container -->
        <v-tab-item>
          <v-card flat min-height="600">
            <v-container>
              <v-card flat height="100%">
                <v-card-title> Container </v-card-title>
                <v-card-subtitle>
                  Static Application Security Testing
                </v-card-subtitle>

                <v-card outlined>
                  <v-container>
                    <v-data-table
                      :headers="scaContainerHeaders"
                      :items="scaContainerItems"
                      :items-per-page="15"
                      dense
                      :expanded.sync="expanded"
                      item-key="index"
                      show-expand
                      :header-props="{ sortIcon: null }"
                      @click:row="dialogMethodeSCAContainer"
                    >
                      <template
                        v-slot:[`item.vulnerability.severity`]="{ item }"
                      >
                        <v-chip
                          outlined
                          small
                          :color="
                            item.vulnerability.severity == 'CRITICAL'
                              ? 'purple'
                              : item.vulnerability.severity == 'HIGH'
                              ? 'red'
                              : item.vulnerability.severity == 'MEDIUM'
                              ? 'orange'
                              : 'blue'
                          "
                        >
                          {{ item.vulnerability.severity }}
                        </v-chip>
                      </template>

                      <template v-slot:[`item.vulnerability.cwe[0]`]="{ item }">
                        {{
                          item.vulnerability.cwe.short
                            ? item.vulnerability.cwe.short
                            : "N/A"
                        }}
                        {{
                          item.vulnerability.cwe.description
                            ? " : " + item.vulnerability.cwe.description
                            : ""
                        }}
                      </template>

                      <template v-slot:[`item.file.path`]="{ item }">
                        {{ item.file.path ? item.file.path : "N/A" }}
                      </template>
                      <template
                        v-slot:[`item.vulnerability.reference`]="{ item }"
                      >
                        <v-btn
                          :href="item.vulnerability.reference"
                          x-small
                          outlined
                          color="primary"
                        >
                          Link
                        </v-btn>
                      </template>

                      <template v-slot:expanded-item="{ headers, item }">
                        <td :colspan="headers.length" class="px-0">
                          <v-card width="100%" flat tile>
                            <v-container>
                              <v-data-table
                                :headers="semgrepDetailsHeaders"
                                :items="[item]"
                                item-key="index"
                                hide-default-footer
                                dense
                              >
                              </v-data-table>
                            </v-container>
                          </v-card>
                        </td>
                      </template>
                    </v-data-table>
                  </v-container>
                </v-card>
              </v-card>
            </v-container>
          </v-card>
        </v-tab-item>

        <v-dialog v-model="dialogSCAContainer" max-width="auto">
          <v-card v-if="dialogSCAContainer">
            <v-container>
              <v-card-title class="text-h4 font-weight-bold">
                {{ dialogItem.vulnerability.cwe.short }}
              </v-card-title>
              <v-card-subtitle class="text-h6 font-weight-medium">
                {{ dialogItem.vulnerability.cwe.description }}
              </v-card-subtitle>
              <v-card-text>
                <v-row>
                  <v-col cols="4">
                    <v-text-field
                      :value="
                        dialogItem.vulnerability.cve
                          ? dialogItem.vulnerability.cve
                          : 'N/A'
                      "
                      label="CVES "
                      outlined
                      readonly
                      hide-details="true"
                    >
                    </v-text-field>
                  </v-col>
                  <v-col cols="4">
                    <v-text-field
                      :value="
                        dialogItem.vulnerability.cwe.likelihood_of_exploit
                          ? dialogItem.vulnerability.cwe.likelihood_of_exploit
                          : 'N/A'
                      "
                      label="likelihood of exploit"
                      outlined
                      readonly
                      hide-details="true"
                    >
                    </v-text-field>
                  </v-col>
                  <v-col cols="4">
                    <v-text-field
                      :value="
                        dialogItem.vulnerability.cvss
                          ? dialogItem.vulnerability.cvss
                          : 'N/A'
                      "
                      label="Score "
                      outlined
                      readonly
                      hide-details="true"
                    >
                    </v-text-field>
                  </v-col>
                </v-row>
              </v-card-text>
              <v-container class="py-0">
                <v-card-title class="pb-1"> Consequences </v-card-title>
                <v-data-table
                  :headers="consequencesHeaders"
                  :items="dialogItem.vulnerability.cwe.consequences"
                  item-key="index"
                  :items-per-page="8"
                >
                  <template v-slot:no-data>
                    <div class="text-h6 font-weight-black">NO DATA HERE!</div>
                  </template>

                  <template v-slot:[`item.Scope`]="{ item }">
                    <v-row dense class="my-1">
                      <v-col
                        v-for="(scope, index) in item.Scope"
                        :key="index"
                        cols="12"
                      >
                        <v-chip outlined color="primary" small>
                          {{ scope }}
                        </v-chip>
                      </v-col>
                    </v-row>
                  </template>

                  <template v-slot:[`item.Impact`]="{ item }">
                    <v-row dense>
                      <v-col
                        v-for="(impact, index) in item.Impact"
                        :key="index"
                        cols="12"
                      >
                        <v-chip outlined color="secondary" small>
                          {{ impact }}
                        </v-chip>
                      </v-col>
                    </v-row>
                  </template>
                </v-data-table>
              </v-container>
              <v-container class="py-1">
                <v-card-title class="py-1"> Observed Examples </v-card-title>
                <v-data-table
                  :headers="observedExamplesHeaders"
                  :items="
                    dialogItem.vulnerability.cwe.observed_examples
                      ? dialogItem.vulnerability.cwe.observed_examples
                      : []
                  "
                  item-key="index"
                  :items-per-page="8"
                  dense
                >
                  <template v-slot:no-data>
                    <div class="text-h6 font-weight-black">NO DATA HERE!</div>
                  </template>
                  <template v-slot:[`item.Link`]="{ item }">
                    <v-chip outlined color="primary" x-small :href="item.Link">
                      Link</v-chip
                    >
                  </template>
                </v-data-table>
              </v-container>
            </v-container>
          </v-card>
        </v-dialog>

        <!-- DAST -->
        <v-tab-item>
          <v-card flat min-height="600">
            <v-container>
              <v-card flat height="100%">
                <v-card-title> Semgrep </v-card-title>
                <v-card-subtitle>
                  Static Application Security Testing
                </v-card-subtitle>

                <v-card outlined>
                  <v-container>
                    <v-data-table
                      :headers="dastHeaders"
                      :items="dastItems"
                      :items-per-page="15"
                      dense
                      :expanded.sync="expanded"
                      item-key="index"
                      show-expand
                      @click:row="dialogMethodeDAST"
                    >
                      <template v-slot:[`item.vulnerability.cwe[0]`]="{ item }">
                        {{
                          item.vulnerability.cwe.short
                            ? item.vulnerability.cwe.short
                            : "N/A"
                        }}
                        {{
                          item.vulnerability.cwe.description
                            ? " : " + item.vulnerability.cwe.description
                            : ""
                        }}
                      </template>
                      <template
                        v-slot:[`item.vulnerability.severity`]="{ item }"
                      >
                        <v-chip
                          outlined
                          small
                          :color="
                            item.vulnerability.severity == 'CRITICAL'
                              ? 'purple'
                              : item.vulnerability.severity == 'HIGH'
                              ? 'red'
                              : item.vulnerability.severity == 'MEDIUM'
                              ? 'orange'
                              : 'blue'
                          "
                        >
                          {{ item.vulnerability.severity }}
                        </v-chip>
                      </template>
                      <template
                        v-slot:[`item.vulnerability.reference`]="{ item }"
                      >
                        <v-btn
                          :href="item.vulnerability.reference"
                          x-small
                          outlined
                          color="primary"
                        >
                          Link
                        </v-btn>
                      </template>

                      <template v-slot:[`item.alert[0]`]="{ item }">
                        <v-chip small outlined color="brown">
                          {{ item.alert.count }}</v-chip
                        >
                      </template>

                      <template v-slot:expanded-item="{ headers, item }">
                        <td :colspan="headers.length" class="px-0">
                          <v-card width="100%" flat tile>
                            <v-container>
                              <v-data-table
                                :headers="semgrepDetailsHeaders"
                                :items="[item]"
                                item-key="index"
                                hide-default-footer
                                dense
                              >
                              </v-data-table>
                            </v-container>
                          </v-card>
                        </td>
                      </template>
                    </v-data-table>
                  </v-container>
                </v-card>
              </v-card>
            </v-container>
          </v-card>
        </v-tab-item>

        <v-dialog v-model="dialogDAST" max-width="auto">
          <v-card v-if="dialogDAST">
            <v-container>
              <v-card-title class="text-h4 font-weight-bold">
                {{ dialogItem.vulnerability.cwe.short }}
              </v-card-title>
              <v-card-subtitle class="text-h6 font-weight-medium">
                {{ dialogItem.vulnerability.cwe.description }}
              </v-card-subtitle>

              <v-container class="py-0">
                <v-card-title class="pb-1"> Alert Instances </v-card-title>
                <v-data-table
                  :headers="instancesHeaders"
                  :items="dialogItem.alert.instances"
                  item-key="index"
                  :items-per-page="8"
                  :header-props="{ sortIcon: null }"
                  dense
                >
                  <template v-slot:no-data>
                    <div class="text-h6 font-weight-black">NO DATA HERE!</div>
                  </template>

                  <template v-slot:[`item.Scope`]="{ item }">
                    <v-row dense class="my-1">
                      <v-col
                        v-for="(scope, index) in item.Scope"
                        :key="index"
                        cols="12"
                      >
                        <v-chip outlined color="primary" small>
                          {{ scope }}
                        </v-chip>
                      </v-col>
                    </v-row>
                  </template>

                  <template v-slot:[`item.Impact`]="{ item }">
                    <v-row dense>
                      <v-col
                        v-for="(impact, index) in item.Impact"
                        :key="index"
                        cols="12"
                      >
                        <v-chip outlined color="secondary" small>
                          {{ impact }}
                        </v-chip>
                      </v-col>
                    </v-row>
                  </template>
                </v-data-table>
              </v-container>

              <v-container class="py-0">
                <v-card-title class="pb-1"> Consequences </v-card-title>
                <v-data-table
                  :headers="consequencesHeaders"
                  :items="dialogItem.vulnerability.cwe.consequences"
                  item-key="index"
                  :items-per-page="8"
                  dense
                >
                  <template v-slot:no-data>
                    <div class="text-h6 font-weight-black">NO DATA HERE!</div>
                  </template>

                  <template v-slot:[`item.Scope`]="{ item }">
                    <v-row dense class="my-1">
                      <v-col
                        v-for="(scope, index) in item.Scope"
                        :key="index"
                        cols="12"
                      >
                        <v-chip outlined color="primary" small>
                          {{ scope }}
                        </v-chip>
                      </v-col>
                    </v-row>
                  </template>

                  <template v-slot:[`item.Impact`]="{ item }">
                    <v-row dense>
                      <v-col
                        v-for="(impact, index) in item.Impact"
                        :key="index"
                        cols="12"
                      >
                        <v-chip outlined color="secondary" small>
                          {{ impact }}
                        </v-chip>
                      </v-col>
                    </v-row>
                  </template>
                </v-data-table>
              </v-container>
              <v-container class="py-1">
                <v-card-title class="py-1"> Observed Examples </v-card-title>
                <v-data-table
                  :headers="observedExamplesHeaders"
                  :items="
                    dialogItem.vulnerability.cwe.observed_examples
                      ? dialogItem.vulnerability.cwe.observed_examples
                      : []
                  "
                  item-key="index"
                  :items-per-page="8"
                  dense
                >
                  <template v-slot:no-data>
                    <div class="text-h6 font-weight-black">NO DATA HERE!</div>
                  </template>
                  <template v-slot:[`item.Link`]="{ item }">
                    <v-chip outlined color="primary" x-small :href="item.Link">
                      Link</v-chip
                    >
                  </template>
                </v-data-table>
              </v-container>
            </v-container>
          </v-card>
        </v-dialog>

        <!-- Deploy -->
        <v-tab-item>
          <v-card flat height="100%">
            <v-container>
              <v-card-title> Deploy Log </v-card-title>
              <v-card outlined dark>
                <v-container>
                  <pre>{{ deployLog }}</pre>
                </v-container>
              </v-card>
            </v-container>
          </v-card>
        </v-tab-item>
      </v-tabs>

      <!-- Overlay -->
      <v-overlay :value="overlay">
        <v-progress-circular indeterminate size="64"></v-progress-circular>
      </v-overlay>
    </v-card>
  </div>
</template>

<script>
import { get_jobs_latest, get_artifacts_by_job_name } from "../modules/gitlab";
import { gather_data, get_filtered_data } from "../modules/helper";

export default {
  name: "DashboardView",
  props: ["group_data"],

  data() {
    return {
      overlay: false,
      tabs: [
        { icon: "mdi-bug-outline", label: "Overview" },
        {
          icon: "mdi-package-variant-closed",
          label: "Package",
          clickAction: "package"
        },
        { icon: "mdi-infinity", label: "SAST-Semgrep" },
        { icon: "mdi-pipe-leak", label: "SAST-Gitleak" },
        { icon: "mdi-cube-scan", label: "SCA-Package" },
        {
          icon: "mdi-upload-network-outline",
          label: "Publish",
          clickAction: "publish-container"
        },
        { icon: "mdi-contain", label: "SCA-Container" },
        { icon: "mdi-shield-search", label: "DAST" },
        {
          icon: "mdi-truck-delivery-outline",
          label: "Deploy",
          clickAction: "deploy"
        }
      ],
      tabsCWECVE: null,

      project_id: 682, // 681:todo-list, 682:juice-shop
      jobs: [],
      jobsDetails: [],
      expanded: [],
      packageLog: "",
      publishLog: "",
      deployLog: "",
      dialogCWE: false,
      dialogSCAContainer: false,
      dialogDAST: false,
      dialogItem: [],
      observedExamplesHeaders: [
        {
          text: "Reference",
          value: "Reference",
          sortable: false
        },
        {
          text: "Description",
          value: "Description"
        },
        {
          text: "Link",
          value: "Link"
        }
      ],
      consequencesHeaders: [
        {
          text: "Scope",
          value: "Scope",
          sortable: false
        },
        {
          text: "Impact",
          value: "Impact"
        },
        {
          text: "Description",
          value: "Note"
        }
      ],
      CWEHeaders: [
        {
          text: "Pos.",
          value: "index",
          width: "1%",
          align: "center",
          class: ""
        },

        {
          text: "Count",
          value: "count",
          width: "auto",
          class: "px-2 ",
          cellClass: "px-2 ",
          align: "center"
        },
        {
          text: "ID",
          value: "id.short",
          width: "15%",
          class: "px-2 ",
          cellClass: "px-2"
        },
        {
          text: "Description",
          value: "description",
          width: "auto",
          class: "px-2 ",
          cellClass: "px-2",
          default: "N/A"
        },
        {
          text: "Likelihood of Exploit ",
          value: "id.likelihood_of_exploit",
          width: "auto",
          class: "px-2  ",
          cellClass: "px-2"
        }
      ],
      CWEItems: [],
      CVEHeaders: [
        {
          text: "Pos.",
          value: "index",
          align: "center",
          width: "auto"
        },
        { text: "ID", value: "id", width: "auto" },
        {
          text: "Description",
          value: "description",
          width: "auto"
        },
        {
          text: "CVE Score",
          value: "cvss",
          align: "center",

          width: "auto"
        },
        {
          text: "Reference",
          value: "reference",
          width: "auto"
        }
      ],
      CVEItems: [],
      semgrepHeaders: [
        { text: "CWE", value: "vulnerability.cwe[0]", width: "auto" },
        { text: "OWASP", value: "vulnerability.owasp", width: "auto" },
        {
          text: "Severity",
          value: "vulnerability.severity",
          width: "auto"
        },
        {
          text: "Confidence",
          value: "vulnerability.confidence",
          width: "auto"
        },
        {
          text: "File Path",
          value: "file.path",
          width: "auto",
          cellClass: "custom-header-cell"
        },
        { text: "Line", value: "file.line", width: "auto" },
        { text: "Column", value: "file.column", width: "auto" },
        {
          text: "Reference",
          value: "vulnerability.reference",
          width: "auto",
          cellClass: "custom-header-cell"
        }
      ],
      semgrepItems: [],
      semgrepDetailsHeaders: [
        {
          text: "Description",
          value: "description",
          width: "auto"
        }
      ],
      gitleaksHeaders: [
        {
          text: "Description",
          value: "description",
          width: "auto"
        },
        { text: "CWE", value: "vulnerability.cwe[0]", width: "auto" },
        { text: "OWASP", value: "vulnerability.owasp", width: "auto" },
        {
          text: "Severity",
          value: "vulnerability.severity",
          width: "auto"
        },
        {
          text: "File Path",
          value: "file.path",
          width: "auto",
          cellClass: "custom-header-cell"
        },
        { text: "Line", value: "file.line", width: "auto" },
        { text: "Column", value: "file.column", width: "auto" }
      ],
      gitleaksItems: [],
      scaPackageHeaders: [
        { text: "CWE", value: "vulnerability.cwe[0]", width: "auto" },
        { text: "CVE", value: "vulnerability.cve", width: "auto" },
        {
          text: "Severity",
          value: "vulnerability.severity",
          width: "auto"
        },
        { text: "File Path", value: "file.path", width: "auto" },

        {
          text: "Reference",
          value: "vulnerability.reference",
          width: "auto",
          cellClass: "custom-header-cell"
        }
      ],
      scaPackageItems: [],
      scaContainerHeaders: [
        { text: "CWE", value: "vulnerability.cwe[0]", width: "auto" },
        { text: "CVE", value: "vulnerability.cve", width: "auto" },
        { text: "Score", value: "vulnerability.cvss", width: "auto" },
        {
          text: "File Path",
          value: "file.path",
          width: "auto",
          cellClass: "custom-header-cell"
        },
        {
          text: "Reference",
          value: "vulnerability.reference",
          width: "auto",
          cellClass: "custom-header-cell"
        },
        {
          text: "Severity",
          value: "vulnerability.severity",
          width: "auto"
        }
      ],
      scaContainerItems: [],
      dastHeaders: [
        { text: "CWE", value: "vulnerability.cwe[0]", width: "auto" },
        { text: "Alert Name", value: "alert.name", width: "auto" },
        { text: "Alert Count", value: "alert[0]", width: "auto" },
        {
          text: "Severity",
          value: "vulnerability.severity",
          width: "auto"
        },
        {
          text: "Reference",
          value: "vulnerability.reference",
          width: "auto",
          cellClass: "custom-header-cell"
        }
      ],
      dastItems: [],
      instancesHeaders: [
        {
          text: "Attack",
          value: "attack",
          width: "auto",
          cellClass: "custom-header-cell"
        },
        {
          text: "Evidence",
          value: "evidence",
          width: "auto",
          cellClass: "custom-header-cell"
        },
        {
          text: "Methode",
          value: "method",
          width: "auto",
          cellClass: "custom-header-cell"
        },
        {
          text: "Other Info",
          value: "otherinfo",
          width: "auto",
          cellClass: "custom-header-cell"
        },
        {
          text: "Uri",
          value: "uri",
          width: "auto",
          cellClass: "custom-header-cell"
        }
      ],
      severities: [
        { severity: "CRITICAL", count: 0 },
        { severity: "HIGH", count: 0 },
        { severity: "MEDIUM", count: 0 },
        { severity: "LOW", count: 0 }
      ],
      timelineJobs: [],
      teamMembers: [
        {
          name: "Julian Thiele",
          avatar: "https://avatars.githubusercontent.com/u/41455100?v=4"
        },
        {
          name: "Michel Franz",
          avatar: "https://avatars.githubusercontent.com/u/95618311?v=4"
        },
        {
          name: "Juri Kaemper",
          avatar: "https://avatars.githubusercontent.com/u/94537452?v=4"
        },
        {
          name: "Felix Mhler",
          avatar: "https://avatars.githubusercontent.com/u/104578023?v=4"
        },
        {
          name: "Christian Pacheco Lopz",
          avatar: "https://avatars.githubusercontent.com/u/104578120?s=400&v=4"
        }
      ],
      jobVulnerabilitiesCount: []
    };
  },
  mounted() {
    this.get_latest_jobs(this.project_id);
    this.load_tab({ label: "Overview" });
  },
  methods: {
    async get_latest_jobs(project_id) {
      const response = await get_jobs_latest(project_id);

      this.jobs = response.sort((a, b) => {
        return new Date(a.created_at) - new Date(b.created_at);
      });

      this.timelineJobs = this.jobs.map((obj) => {
        return {
          id: obj.id,
          status: obj.status,
          stage: obj.stage,
          name: obj.name,
          started_at: obj.started_at,
          finished_at: obj.finished_at,
          duration: obj.duration,
          queued_duration: obj.queued_duration,
          user: {
            id: obj.user.id,
            web_url: obj.user.web_url
          },
          web_url: obj.web_url,
          artifacts: obj.artifacts,
          pipeline: {
            id: obj?.pipeline.id,
            created_at: obj?.pipeline.created_at,
            web_url: obj?.pipeline.web_url,
            updated_at: obj?.pipeline.updated_at
          },
          commit: {
            short_id: obj?.commit.short_id,
            message: obj?.commit.message,
            author_name: obj?.commit.author_name,
            web_url: obj?.commit.web_url
          }
        };
      });
    },
    async get_gathered_data(project_id) {
      const data = await gather_data(project_id);
      console.log("get_gathered_data", data);

      // reset severities
      this.severities = [
        { severity: "CRITICAL", count: 0 },
        { severity: "HIGH", count: 0 },
        { severity: "MEDIUM", count: 0 },
        { severity: "LOW", count: 0 }
      ];

      data.forEach((item) => {
        if (item.vulnerability && item.vulnerability.severity) {
          if (item.vulnerability.severity == "CRITICAL") {
            this.severities.find((element) => {
              if (element.severity == "CRITICAL") {
                element.count = element.count + 1;
              }
            });
          } else if (item.vulnerability.severity == "HIGH") {
            this.severities.find((element) => {
              if (element.severity == "HIGH") {
                element.count = element.count + 1;
              }
            });
          } else if (item.vulnerability.severity == "MEDIUM") {
            this.severities.find((element) => {
              if (element.severity == "MEDIUM") {
                element.count = element.count + 1;
              }
            });
          } else if (item.vulnerability.severity == "LOW") {
            this.severities.find((element) => {
              if (element.severity == "LOW") {
                element.count = element.count + 1;
              }
            });
          }
        }
      });

      // count unique cves
      let counts = {};
      data.forEach((el) => {
        if (!el.vulnerability.cve) return;
        const cve = el.vulnerability.cve;
        const job = el.job;
        if (counts[cve]?.jobs?.length) {
          counts[cve].jobs.push(job);
          counts[cve].count++ || 1;
        } else {
          counts[cve] = {
            cve: cve,
            cvss: el.vulnerability.cvss,
            description: el.description,
            count: counts[cve]?.count + 1 || 1,
            jobs: [job],
            reference: el.vulnerability.reference
          };
        }
      });
      // get sum of counts without modifying the object
      let sum = 0;
      Object.keys(counts).forEach((key) => {
        sum += counts[key].count;
      });
      console.log("cves", { sum }, counts);

      this.CVEItems = [];
      for (const key in counts) {
        if (counts.hasOwnProperty(key)) {
          const obj = counts[key];

          const newObj = {
            id: obj.cve,
            cvss: obj.cvss,
            description: obj.description.slice(0, 90) + "...",
            count: obj.count,
            jobs: obj.jobs,
            reference: obj.reference
          };
          this.CVEItems.push(newObj);
        }
      }
      console.log("CVEItems", this.CVEItems);
      this.CVEItems.sort((a, b) => b.cvss - a.cvss);
      this.CVEItems.forEach((obj, index) => {
        obj.index = index + 1; // Add the index property starting from 1
      });

      // count cwes and group cves
      counts = {};

      data.forEach((el) => {
        if (!el.vulnerability.cwe || el.vulnerability.cwe.short == null) return;

        var previousDescription = null;
        //el.vulnerability.cwe.forEach((cwe) => {
        counts[el.vulnerability.cwe?.short] = {
          cwe: el.vulnerability.cwe,
          description:
            el.vulnerability.cwe.description !== null &&
            el.vulnerability.cwe.description
              ? el.vulnerability.cwe.description
              : previousDescription,
          count: counts[el.vulnerability.cwe.short]?.count + 1 || 1,
          cves: el.vulnerability.cve
        };

        if (el.vulnerability.cwe.description !== null) {
          previousDescription = el.vulnerability.cwe.description; // Update the previousDescription variable if the current description is non-null
        }
      });
      console.log("cwes", counts);

      this.CWEItems = [];
      for (const key in counts) {
        if (counts.hasOwnProperty(key)) {
          const obj = counts[key];

          const newObj = {
            count: obj.count,
            cves: obj.cves,
            description: obj.description,
            id: obj.cwe
          };
          this.CWEItems.push(newObj);
        }
      }
      this.CWEItems.sort((a, b) => b.count - a.count);
      this.CWEItems.forEach((obj, index) => {
        obj.index = index + 1; // Add the index property starting from 1
      });

      // count how many elements came from which job
      counts = {};
      data.forEach((el) => {
        counts = {
          ...counts,
          [el.job]: counts[el.job] + 1 || 1
        };
      });
      sum = 0;
      Object.keys(counts).forEach((key) => {
        sum += counts[key];
      });
      this.jobVulnerabilitiesCount = counts;

      this.overlay = false;
    },
    add_index_to_array(array) {
      array.forEach((obj, index) => {
        obj.index = index + 1; // Add the index property starting from 1
      });
      return array;
    },
    async load_tab(tab) {
      this.overlay = true;
      let data;
      switch (tab.label) {
        case "Overview":
          await this.get_gathered_data(this.project_id);
          break;
        case "Package":
        case "Publish":
        case "Deploy":
          await this.show_artifact(tab.clickAction);
          break;
        case "SAST-Semgrep":
          data = await get_filtered_data(this.project_id, "sast-semgrep");
          this.semgrepItems = this.add_index_to_array(data);
          break;
        case "SAST-Gitleak":
          data = await get_filtered_data(this.project_id, "sast-gitleaks");
          this.gitleaksItems = this.add_index_to_array(data);
          break;
        case "SCA-Package":
          data = await get_filtered_data(
            this.project_id,
            "sca-package-dependency-check"
          );
          this.scaPackageItems = this.add_index_to_array(data);
          break;
        case "SCA-Container":
          data = await get_filtered_data(
            this.project_id,
            "sca-container-trivy"
          );
          this.scaContainerItems = this.add_index_to_array(data);
          break;
        case "DAST":
          data = await get_filtered_data(this.project_id, "dast-zap");
          this.dastItems = this.add_index_to_array(data);
          break;
        default:
          console.log(`Unknown tab: ${tab.label}`);
      }
      this.overlay = false;
    },
    async show_artifact(jobname) {
      if (!jobname) return;
      this.overlay = true;
      const response = await get_artifacts_by_job_name(
        this.project_id,
        jobname
      );
      if (jobname == "package") this.packageLog = response[0].data;
      else if (jobname == "publish-container")
        this.publishLog = response[0].data;
      else if (jobname == "deploy") this.deployLog = response[0].data;
      this.overlay = false;
    },
    getFontSize() {
      if (window.innerWidth <= 800) {
        return "12px"; // Kleinere Schriftgre fr kleine Displays
      } else {
        return "42px"; // Standard-Schriftgre
      }
    },
    getTimePassed(updatedAt) {
      const updatedDate = new Date(updatedAt);
      const currentDate = new Date();

      const timeDiff = currentDate - updatedDate;
      const daysPassed = Math.floor(timeDiff / (1000 * 60 * 60 * 24)); // Calculate days passed
      const hoursPassed = Math.floor(timeDiff / (1000 * 60 * 60)); // Calculate hours passed
      if (hoursPassed < 24) {
        return `${hoursPassed} Hours ago`;
      } else {
        return `${daysPassed} Days ago`;
      }
    },
    getAuthorAvatar(authorName) {
      const member = this.teamMembers.find((member) =>
        member.name.includes(authorName)
      );
      return member ? member.avatar : "";
    },
    getTimeTaken(finishedAt, startedAt) {
      const finishedTime = new Date(finishedAt);
      const startedTime = new Date(startedAt);
      const timeDiff = Math.abs(finishedTime - startedTime);
      const minutes = Math.floor(timeDiff / (1000 * 60));
      const seconds = Math.floor((timeDiff / 1000) % 60);

      if (minutes >= 60) {
        const hours = Math.floor(minutes / 60);
        return `${hours}hours ${minutes % 60}m`;
      } else if (minutes >= 1) {
        return `${minutes}min`;
      } else {
        return `${seconds}sec`;
      }
    },
    getVulnerabilityCount(jobName) {
      return this.jobVulnerabilitiesCount[jobName] || 0;
    },
    getJobIcon(status) {
      const iconMap = {
        created: "mdi-clock-outline",
        pending: "mdi-clock",
        running: "mdi-loading",
        success: "mdi-check",
        failed: "mdi-close",
        canceled: "mdi-alert",
        skipped: "mdi-arrow-right",
        manual: "mdi-hand",
        scheduled: "mdi-clock",
        blocked: "mdi-circle",
        expired: "",
        deleted: "mdi-delete"
      };
      return iconMap[status] || "";
    },
    getJobColor(status) {
      const classMap = {
        created: "blue",
        pending: "yellow",
        running: "deep-purple",
        success: "green",
        failed: "red",
        canceled: "orange",
        skipped: "teal",
        manual: "purple",
        scheduled: "blue",
        blocked: "red",
        expired: "",
        deleted: "grey"
      };
      return classMap[status] || "";
    },
    getSeverityColor(severity) {
      if (!severity) return "grey";

      switch (severity.toUpperCase()) {
        case "CRITICAL":
          return "red";
        case "HIGH":
          return "orange";
        case "MEDIUM":
          return "yellow";
        default:
          return "blue";
      }
    },
    dialogMethodeCWE(item) {
      this.dialogCWE = true;
      this.dialogItem = item;
    },
    dialogMethodeSCAContainer(item) {
      this.dialogSCAContainer = true;
      this.dialogItem = item;
    },
    dialogMethodeDAST(item) {
      this.dialogDAST = true;
      this.dialogItem = item;
    }
  }
};
</script>
<style>
.custom-header-cell {
  word-break: break-all;
}
</style>
